<?xml version="1.0" encoding="utf-8"?>
<TfrxReport ScriptLanguage="PascalScript" ScriptText.text="procedure bHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with bHeader, Engine do&#13;&#10;  begin&#13;&#10;  if (mPecaRoot.Memo = '') and&#13;&#10;     ([DialogForm.qrReport.&#34;R_CURRLEVEL&#34;] = 0) then&#13;&#10;  begin&#13;&#10;    StrMemo1 := 'Peça: ' + [DialogForm.qrReport.&#34;R_COD_REF&#34;] + ' - ' +&#13;&#10;                      [DialogForm.qrReport.&#34;R_DSC_PEC&#34;];&#13;&#10;    StrMemo2 := [DialogForm.qrReport.&#34;R_QTD_PEC&#34;];&#13;&#10;  end;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure bMasterOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with bMaster, Engine do&#13;&#10;  begin&#13;&#10;  mPecaRoot.Memo := StrMemo1;&#13;&#10;  mPecaQtd.Memo  := StrMemo2;&#13;&#10;  bMaster.Visible := not (([DialogForm.qrReport.&#34;R_CURRLEVEL&#34;] &#62; 0)    and&#13;&#10;                         ([DialogForm.qrReport.&#34;R_MOT_NVER&#34;] = 'N/A'));&#13;&#10;  bDetail.Visible := bMaster.Visible;&#13;&#10;  if bMaster.Visible then&#13;&#10;  begin&#13;&#10;    rImg_Pec.Visible := ([DialogForm.qrReport.&#34;R_FLAG_TIMG&#34;] &#62; -1);&#13;&#10;    if rImg_Pec.Visible then&#13;&#10;    begin&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG&#34;] = 0 then&#13;&#10;        rImg_Pec.BlobType := btJPG;&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG&#34;] = 1 then&#13;&#10;        rImg_Pec.BlobType := btWMF;&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG&#34;] = 2 then&#13;&#10;        rImg_Pec.BlobType := btBMP;&#13;&#10;    end;&#13;&#10;    pvRootPart.Visible := ([DialogForm.qrReport.&#34;R_FLAG_TIMG_ROOT&#34;] &#62; -1);&#13;&#10;    if pvRootPart.Visible then&#13;&#10;    begin&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG_ROOT&#34;] = 0 then&#13;&#10;        pvRootPart.BlobType := btJPG;&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG_ROOT&#34;] = 1 then&#13;&#10;        pvRootPart.BlobType := btWMF;&#13;&#10;      if [DialogForm.qrReport.&#34;R_FLAG_TIMG_ROOT&#34;] = 2 then&#13;&#10;        pvRootPart.BlobType := btBMP;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure bDetailOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with bDetail, Engine do&#13;&#10;  begin&#13;&#10;  StrAux1 := [STR([DialogForm.qrDetalhe.&#34;R_PK_FASES_PRODUCAO&#34;])];&#13;&#10;  StrAux2 := [STR([DialogForm.qrDetalhe.&#34;R_PK_OPERACOES&#34;])];&#13;&#10;  StrAux3 := StrAux1 + StrAux2;&#13;&#10;  bCodBar.Memo := [INT(StrAux3)];&#13;&#10;  if [STR([DialogForm.qrDetalhe.&#34;R_ALT_MAX&#34;])] &#62; '0,0000' then&#13;&#10;    mMedMax.Visible := True&#13;&#10;  else&#13;&#10;    mMedMax.Visible := False;&#13;&#10;  if [DialogForm.qrDetalhe.&#34;R_DSC_DET&#34;] = '' then&#13;&#10;  begin&#13;&#10;    mlDscDet.Visible := False;&#13;&#10;    mDscDet.Visible  := False;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    mlDscDet.Visible := True;&#13;&#10;    mDscDet.Visible  := True;&#13;&#10;  end;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure lOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with lOk, Engine do&#13;&#10;  begin&#13;&#10;  eRefProd.Text := [UPPERCASE(eRefProd.Text)]&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.&#13;&#10;" Propdata="0844617461736574730E0107446174615365740D0B446174615365744E616D65060C667244424461746153657431000107446174615365740D0B446174615365744E616D65060E6672557365724461746173657431000107446174615365740D0B446174615365744E616D65060E6672557365724461746173657432000107446174615365740D0B446174615365744E616D6506095F71725265706F7274000107446174615365740D0B446174615365744E616D65060A5F7172446574616C68650000095661726961626C65730D00" ReportOptions.Name="Ordem de Produção" ReportOptions.Author="" ReportOptions.Description.text="" ReportOptions.CreateDate="37998,4267180787" ReportOptions.LastChange="38224,4363904282" ReportOptions.VersionMajor="0" ReportOptions.VersionMinor="9" ReportOptions.VersionRelease="4" ReportOptions.VersionBuild="7" ReportOptions.Password="">
<TfrxReportPage Name="Page1" Orientation="poPortrait" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="3" RightMargin="5" TopMargin="10" BottomMargin="10" Columns="0" ColumnWidth="0">
<TfrxPageHeader Name="bHeader" Top="36" Height="100" Columns="1" ColumnWidth="200" ColumnGap="20" OnBeforePrint="bHeaderOnBeforePrint"/>
<TfrxPageFooter Name="bFooter" Top="600" Height="24" Columns="1" ColumnWidth="200" ColumnGap="20"/>
<TfrxMasterData Name="bMaster" Top="156" Height="344" Columns="1" ColumnWidth="200" ColumnGap="20" PrintIfDetailEmpty="True" OnBeforePrint="bMasterOnBeforePrint" DataSetName="_qrReport"/>
<TfrxDetailData Name="bDetail" Top="520" Height="62" Columns="1" ColumnWidth="200" ColumnGap="20" OnBeforePrint="bDetailOnBeforePrint" DataSetName="_qrDetalhe"/>
<TfrxMemoView Name="mFase" Left="108" Top="522" Width="280" Height="36" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrDetalhe.&#34;R_DSC_FASE&#34;]&#13;&#10;        [DialogForm.qrDetalhe.&#34;R_DSC_OPE&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="mMedMax" Left="356" Top="522" Width="360" Height="36" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Medida: [FORMATFLOAT('###0.0###', [DialogForm.qrDetalhe.&#34;R_ALT_MAX&#34;])] x [FORMATFLOAT('###0.0###', [DialogForm.qrDetalhe.&#34;R_LARG_MAX&#34;])] x [FORMATFLOAT('###0.0###', [DialogForm.qrDetalhe.&#34;R_PROF_MAX&#34;])]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-16" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="2" VAlign="0"/>
<TfrxMemoView Name="NameEmp" Left="232" Top="84" Width="484" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[Dados.Empresa.&#34;RAZ_SOC&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="Date" Left="12" Top="108" Width="96" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DATE]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="Time" Left="620" Top="108" Width="96" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[TIME]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="1" VAlign="0"/>
<TfrxMemoView Name="ReportInfo" Left="540" Top="604" Width="172" Height="16" Color="536870911" Frame.Typ="4" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Página [PAGE#] de [TOTALPAGES]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-11" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="1" VAlign="0"/>
<TfrxLineView Name="Line1" Left="0" Top="132" Width="724" Height="0" Color="16777215" Frame.Typ="4" Frame.Width="2" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0"/>
<TfrxMemoView Name="SysInfo" Left="8" Top="604" Width="532" Height="16" Color="536870911" Frame.Typ="4" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Sistema Processa Open Source E.R.P. - Versão:[VMAJOR].[VMINOR].[VRELEASE].[VBUILD]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-11" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxRoundRectView Name="Title" Left="232" Top="40" Width="484" Height="40" Color="16777215" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[REPORTNAME]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-24" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="2"/>
<TfrxPictureView Name="Logo" Left="12" Top="40" Width="216" Height="64" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[Dados.Empresa.&#34;LOGO_EMP&#34;]&#13;&#10;" Align="0" Restrictions="0"/>
<TfrxMemoView Name="mPecaRoot" Left="12" Top="157" Width="560" Height="19" Color="536870911" Frame.Typ="8" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="Arial" Font.Height="-16" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="Memo1" Left="12" Top="184" Width="704" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrReport.&#34;R_COD_REF&#34;] - [DialogForm.qrReport.&#34;R_DSC_PEC&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-16" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxPictureView Name="rImg_Pec" Left="356" Top="208" Width="360" Height="288" Color="536870911" Frame.Typ="15" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrReport.&#34;R_IMG_PEC&#34;]&#13;&#10;" Align="0" Restrictions="0"/>
<TfrxMemoView Name="Memo2" Left="12" Top="324" Width="344" Height="116" Color="536870911" Frame.Typ="15" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="O b s e r v a ç õ e s da Peça:&#13;&#10;[DialogForm.qrReport.&#34;R_OBS_PEC&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="mPecaQtd" Left="620" Top="157" Width="96" Height="19" Color="536870911" Frame.Typ="8" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="Memo4" Left="192" Top="440" Width="164" Height="56" Color="536870911" Frame.Typ="15" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrReport.&#34;R_QTD_PEC&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-48" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="2" VAlign="0"/>
<TfrxMemoView Name="Memo7" Left="572" Top="157" Width="48" Height="19" Color="536870911" Frame.Typ="8" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Quant.:&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="1" LineSpacing="2" CharSpacing="0" HAlign="1" VAlign="0"/>
<TfrxMemoView Name="Memo8" Left="12" Top="440" Width="180" Height="56" Color="536870911" Frame.Typ="15" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Quantidade de Produção&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="2" VAlign="2"/>
<TfrxMemoView Name="mDscDet" Left="176" Top="560" Width="540" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrDetalhe.&#34;R_DSC_DET&#34;]&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="0" VAlign="0"/>
<TfrxMemoView Name="mlDscDet" Left="108" Top="560" Width="64" Height="20" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="Material:&#13;&#10;" Align="0" Restrictions="0" StretchMode="smMaxHeight" Font.Name="Arial" Font.Height="-13" Font.Color="0" Font.Style="0" LineSpacing="2" CharSpacing="0" HAlign="1" VAlign="0"/>
<TfrxBarCodeView Name="bCodBar" Left="8" Top="523" Width="95" Height="40" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="0&#13;&#10;" Align="0" Restrictions="0" Text="0" BarType="14" CalcCheckSum="1" Rotation="0" ShowText="1" Zoom="1"/>
<TfrxPictureView Name="pvRootPart" Left="12" Top="208" Width="116" Height="116" Color="536870911" Frame.Typ="15" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="[DialogForm.qrReport.&#34;R_IMG_PEC_ROOT&#34;]&#13;&#10;" Align="0" Restrictions="0" Center="True"/>
</TfrxReportPage>
<TfrxDialogPage Name="Page2" Height="212" Left="155" Top="159" Width="380" BorderStyle="3" Caption="Form" Color="-16777201" Position="4">
<TfrxIBXQuery Name="qrReport" Left="132" Top="128" Width="28" Height="28" Color="-16777201" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Propdata="05704C6566740384000470546F70038000" Filter="" SQL.text="select *&#13;&#10; from stp_hierarquia_referencia(:QtdProd, :RefProd, 0 ,0)&#13;&#10;" Propdata="06506172616D730E01044E616D65060751746450726F6408446174615479706507076674466C6F61740A45787072657373696F6E060D6551746450726F642E546578740001044E616D65060752656650726F6408446174615479706507086674537472696E670A45787072657373696F6E060D6552656650726F642E546578740000"/>
<TfrxLabelControl Name="lTitle" Left="8" Top="8" Width="358" Height="33" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-24" Font.Color="-16777208" Font.Style="1" Color="-16777201" Alignment="2" AutoSize="0" Caption="Seleção da Peça" WordWrap="0"/>
<TfrxLabelControl Name="lRefProd" Left="60" Top="60" Width="55" Height="13" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777201" Alignment="1" AutoSize="1" Caption="Referência:" WordWrap="0"/>
<TfrxButtonControl Name="lOk" Left="48" Top="132" Width="75" Height="25" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" OnBeforePrint="lOkOnBeforePrint" OnClick="lOkOnBeforePrint" OnActivate="lOkOnBeforePrint" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777201" Caption="Ok" ModalResult="1"/>
<TfrxButtonControl Name="bCancel" Left="240" Top="132" Width="75" Height="25" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777201" Caption="Cancelar" ModalResult="2"/>
<TfrxLabelControl Name="lQtdProd" Left="60" Top="96" Width="58" Height="13" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777201" Alignment="1" AutoSize="1" Caption="Quantidade:" WordWrap="0"/>
<TfrxEditControl Name="eRefProd" Left="120" Top="56" Width="121" Height="21" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777211" Text="11-" ReadOnly="0"/>
<TfrxEditControl Name="eQtdProd" Left="120" Top="92" Width="121" Height="21" Color="536870911" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Font.Name="MS Sans Serif" Font.Height="-11" Font.Color="-16777208" Font.Style="0" Color="-16777211" Text="1" ReadOnly="0"/>
<TfrxIBXQuery Name="qrDetalhe" Left="176" Top="128" Width="28" Height="28" Color="-16777201" Frame.Typ="0" Frame.Width="1" Frame.Color="0" Frame.Style="0" GapX="2" GapY="1" TagStr="" Memo.text="" Align="0" Restrictions="0" Propdata="05704C65667403B0000470546F70038000" Filter="" SQL.text="select * from STP_GET_INSUMOS_FICHA(1,&#13;&#10;  :R_FK_PECAS_MONTAGEM, :R_FK_FICHA_TECNICA_MONTAGEM)&#13;&#10;&#13;&#10;" Propdata="06506172616D730E01044E616D650613525F464B5F50454341535F4D4F4E544147454D08446174615479706507096674496E74656765720A45787072657373696F6E06000001044E616D65061B525F464B5F46494348415F5445434E4943415F4D4F4E544147454D08446174615479706507096674496E74656765720A45787072657373696F6E06000000"/>
</TfrxDialogPage>
</TfrxReport>
